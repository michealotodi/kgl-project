{% extends "base.html" %}
{% load static %}

{% block title %}Director Dashboard{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="text-primary mb-4">Director Dashboard - All Branches</h2>

  <!-- Total Stats for All Branches -->
  <div class="row text-center">
    <div class="col-md-3 mb-4">
      <div class="p-3 bg-light border rounded shadow-sm">
        <h6>Total Procured (Kg)</h6>
        <p class="display-6">{{ total_procured }}</p>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="p-3 bg-light border rounded shadow-sm">
        <h6>Total Sold (Kg)</h6>
        <p class="display-6">{{ total_sales }}</p>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="p-3 bg-light border rounded shadow-sm">
        <h6>Total Credit Sales (Kg)</h6>
        <p class="display-6">{{ total_credit_sales }}</p>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="p-3 bg-light border rounded shadow-sm">
        <h6>Total Due (UGX)</h6>
        <p class="display-6">UGX {{ total_due }}</p>
      </div>
    </div>
  </div>

  <!-- Stats for Each Branch -->
  <h4 class="text-secondary mt-4">Branch-wise Summary</h4>

  {% for stat in branch_stats %}
    <h5 class="text-primary mt-4">Branch: {{ stat.branch }}</h5>

    <!-- Sales Stats -->
    <div class="row text-center">
      <div class="col-md-3 mb-4">
        <div class="p-3 bg-light border rounded shadow-sm">
          <h6>Total Sold (Kg)</h6>
          <p class="display-6">{{ stat.total_sales }}</p>
        </div>
      </div>
      <div class="col-md-3 mb-4">
        <div class="p-3 bg-light border rounded shadow-sm">
          <h6>Sales Amount (UGX)</h6>
          <p class="display-6">UGX {{ stat.sales_amount }}</p>
        </div>
      </div>
    </div>

    <!-- Credit Sales Stats -->
    <div class="row text-center">
      <div class="col-md-3 mb-4">
        <div class="p-3 bg-light border rounded shadow-sm">
          <h6>Total Credit Sales (Kg)</h6>
          <p class="display-6">{{ stat.total_credit_sales }}</p>
        </div>
      </div>
      <div class="col-md-3 mb-4">
        <div class="p-3 bg-light border rounded shadow-sm">
          <h6>Credit Sales Due (UGX)</h6>
          <p class="display-6">UGX {{ stat.credit_due }}</p>
        </div>
      </div>
    </div>

    <!-- Procurement Stats -->
    <div class="row text-center">
      <div class="col-md-3 mb-4">
        <div class="p-3 bg-light border rounded shadow-sm">
          <h6>Total Procured (Kg)</h6>
          <p class="display-6">{{ stat.total_procured }}</p>
        </div>
      </div>
    </div>
  {% endfor %}

  {% if low_stock_items %}
  <h4 class="text-danger mt-5">Low Stock Items</h4>
  <ul class="list-group">
    {% for item in low_stock_items %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      {{ item.item }} ({{ item.quantity }} Kg)
      <span class="badge bg-warning text-dark">Low</span>
    </li>
    {% endfor %}
  </ul>
  {% endif %}
</div>

<footer class="site-footer mt-5">
  <p>&copy; 2025 KGLApp. All rights reserved.</p>
  <p>Contact us: <a href="mailto:info@kglapp.com">info@kglapp.com</a></p>
</footer>
{% endblock %}
